(()=>{"use strict";var e={433:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.endpoints=t.baseUrl=void 0,t.baseUrl="https://localhost:8000",t.endpoints={record:{create:t.baseUrl+"/record/create"},mal:t.baseUrl+"/mal"}},487:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function c(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}l((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.searchByTitleName=t.createRecord=void 0;const r=n(433),i=n(957);t.createRecord=function(e){return o(this,void 0,void 0,(function*(){return yield fetch(r.endpoints.record.create,{method:"POST",body:JSON.stringify((0,i.camelCaseKeysToUnderscore)(e))})}))},t.searchByTitleName=function(e){return o(this,void 0,void 0,(function*(){return yield fetch(r.endpoints.mal+`?endpoint=/v2/anime?q=${e.slice(0,i.searchMaxLen)}`,{method:"GET"}).then((e=>e.json())).then((e=>e.data[0].node))}))}},957:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.camelCaseKeysToUnderscore=t.searchMaxLen=void 0,t.searchMaxLen=64,t.camelCaseKeysToUnderscore=function e(t){if("object"!=typeof t)return t;for(var n in t){let o=n.replace(/([A-Z])/g,(function(e){return"_"+e.toLowerCase()}));o!=n&&t.hasOwnProperty(n)&&(t[o]=t[n],delete t[n]),"object"==typeof t[o]&&(t[o]=e(t[o]))}return t}},667:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTitleName=void 0,t.getTitleName=function(){var e;return null===(e=document.getElementsByClassName("romanji")[0])||void 0===e?void 0:e.textContent}}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}(()=>{const e=n(487),t=n(667),o=["video.sibnet.ru"],r=["animejoy.ru"];function i(){return r.includes(window.location.host)&&!o.includes(window.location.host)}var a=null;if(i()&&(a=(0,t.getTitleName)(),console.log(a),a?(0,e.searchByTitleName)(a).then((e=>{localStorage.setItem("titleName",e.title),localStorage.setItem("titleImage",e.main_picture.medium),localStorage.setItem("titleId",e.id.toString())})):window.prompt("timeEater: site is supported, but we can't load the title name. Please input the name of title you watching","")),o.includes(window.location.host)){let u,m=document.getElementsByTagName("video")[0];function f(){console.log("timePlayed: ",s),console.log("timeFrom: ",l),console.log("sending..."),s=0,l=0}var c=!1,l=0,s=0,d=0;function v(){c=!0,clearInterval(u),l=Math.round(m.currentTime),s=0,u=setInterval((function(){c&&(s+=1)}),1e3)}function h(e){c=!1,f()}function p(e){(d+=1)%2==0&&f()}m.addEventListener("play",v),m.addEventListener("playing",v),m.addEventListener("ended",h),m.addEventListener("pause",h),document.addEventListener("fullscreenchange",p)}chrome.runtime.onMessage.addListener(((e,t,n)=>{if("popup"===e.from&&"content"===e.subject&&i()){const e={titleName:localStorage.getItem("titleName"),titleImage:localStorage.getItem("titleImage")};console.log(window.location.host),console.log(localStorage),n(e)}}))})()})();